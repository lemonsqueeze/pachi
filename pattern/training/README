General Pattern Matcher
=======================

Pachi has a general pattern matcher that can match various sets of features
(spatial and others). Previous versions used a bayesian large pattern
database inspired by the van der Werf - de Groot - Stern pattern model
(http://pachi.or.cz/pat/), while current implementation uses MM patterns
following Rémi's paper with some tweaks and custom features. See pattern.h
for detailed description of the pattern concept and recognized features,
and Rémi's paper:

  https://www.remi-coulom.fr/Amsterdam2007/


[ MM Training Pipeline ]

- Rebuild Pachi with EXTRA_ENGINES set, so patternscan engine gets built.

- Pick one month of kgs high-dans game records (~500 games):
      https://www.u-go.net/gamerecords/
  This is your training set. Put sgf files in sgf_train/ directory.

-     $ pattern/training/spatial_gen  sgf_train/*.sgf
  Generate spatial dictionary by collecting spatial patterns found at
  least N times in the training set. Will generate patterns_mm.spat
  You should end up with 15k-20k patterns.


-     $ pattern/trainingn/mm_games  sgf_train/*.sgf
  or
      $ pattern/trainingn/mm_games --slow  sgf_train/*.sgf      
  Pattern match all moves in the training set, turning them into teams of
  features suitable for mm tool. Generates mm-pachi.table and mm-input.dat,
  which will be rather large by the time it's done (~800Mb). Because we
  need to run some playouts for the mcowner feature this will take a while
  (--slow version more accurate but much slower).

-     $ pattern/training/mm/mm < mm-input.dat
  Compute optimal gammas for each feature to maximize prediction rate on
  the training set. Needs enough ram to keep everything in memory.
  Generates mm-with-freq.dat

-     $ pattern/training/mm_gammas
  Translate mm's output back into pachi's gammas.
  Writes patterns_mm.gamma.


[ Test ]

- Pick another month of kgs games as your testing set,
  Put in sgf_test/ directory and run:
      $ ln -s sgf_test t-predict/sgf
      $ t-predict/predict -e patternplay
  If all goes well you should get ~34% prediction rate.

- Set/copy artificial gammas for tactical features which won't show up in
  6d+ games but which should get high gammas to be useful in tree search
  (atari:ladder_big, atari:and_cap ...)

- Test again, make sure that doesn't impact prediction rate too much,
  otherwise custom feature / gamma needs fixing.
  
Done !


[ Spatial features ]

"Spatial" features represent a particular configuration of stones in a
circle around the move-to-play; each configuration has its own record in
the dictionary and the spatial feature references only the id in the
dictionary.

Some extra scripts which can be useful as well:

- pattern/byplayer
  Sorts out patterns from given SGF collection by player names, one player
  per file in a dedicated directory. This is useful if you want to use the
  patterns to e.g. recognize games of a player by characteristic
  patterns. Spatial dictionary is autogenerated in full.

- pattern/spatial_show ID
  Shows spatial pattern of given id in 2D plane.

